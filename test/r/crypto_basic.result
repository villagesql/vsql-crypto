INSTALL EXTENSION vsql_crypto;
SELECT LENGTH(vsql_crypto.crypto_version()) > 0;
LENGTH(vsql_crypto.crypto_version()) > 0
1
SELECT HEX(vsql_crypto.digest('test', 'md5'));
HEX(vsql_crypto.digest('test', 'md5'))
098F6BCD4621D373CADE4E832627B4F6
SELECT HEX(vsql_crypto.digest('test', 'sha1'));
HEX(vsql_crypto.digest('test', 'sha1'))
A94A8FE5CCB19BA61C4C0873D391E987982FBBD3
SELECT HEX(vsql_crypto.digest('test', 'sha224'));
HEX(vsql_crypto.digest('test', 'sha224'))
90A3ED9E32B2AAF4C61C410EB925426119E1A9DC53D4286ADE99A809
SELECT HEX(vsql_crypto.digest('test', 'sha256'));
HEX(vsql_crypto.digest('test', 'sha256'))
9F86D081884C7D659A2FEAA0C55AD015A3BF4F1B2B0B822CD15D6C15B0F00A08
SELECT HEX(vsql_crypto.digest('test', 'sha384'));
HEX(vsql_crypto.digest('test', 'sha384'))
768412320F7B0AA5812FCE428DC4706B3CAE50E02A64CAA16A782249BFE8EFC4B7EF1CCB126255D196047DFEDF17A0A9
SELECT HEX(vsql_crypto.digest('test', 'sha512'));
HEX(vsql_crypto.digest('test', 'sha512'))
EE26B0DD4AF7E749AA1A8EE3C10AE9923F618980772E473F8819A5D4940E0DB27AC185F8A0E1D5F84F88BC887FD67B143732C304CC5FA9AD8E6F57F50028A8FF
SELECT HEX(vsql_crypto.digest('', 'sha256'));
HEX(vsql_crypto.digest('', 'sha256'))
E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855
SELECT HEX(vsql_crypto.hmac('test', 'key', 'sha256'));
HEX(vsql_crypto.hmac('test', 'key', 'sha256'))
02AFB56304902C656FCB737CDD03DE6205BB6D401DA2812EFD9B2D36A08AF159
SELECT HEX(vsql_crypto.hmac('data', 'secret', 'sha1'));
HEX(vsql_crypto.hmac('data', 'secret', 'sha1'))
9818E3306BA5AC267B5F2679FE4ABD37E6CD7B54
SELECT HEX(vsql_crypto.hmac('message', 'password', 'md5'));
HEX(vsql_crypto.hmac('message', 'password', 'md5'))
F37438341E3D22AA11B4B2E838120DCF
SELECT LENGTH(vsql_crypto.gen_random_uuid());
LENGTH(vsql_crypto.gen_random_uuid())
36
SELECT vsql_crypto.gen_random_uuid() != vsql_crypto.gen_random_uuid();
vsql_crypto.gen_random_uuid() != vsql_crypto.gen_random_uuid()
1
SELECT LENGTH(vsql_crypto.gen_random_bytes(16));
LENGTH(vsql_crypto.gen_random_bytes(16))
16
SELECT LENGTH(vsql_crypto.gen_random_bytes(32));
LENGTH(vsql_crypto.gen_random_bytes(32))
32
SELECT LENGTH(vsql_crypto.gen_random_bytes(1));
LENGTH(vsql_crypto.gen_random_bytes(1))
1
SET @plaintext = 'Hello, World!';
SET @key = 'my-secret-key-16';
SET @encrypted = vsql_crypto.encrypt(@plaintext, @key, 'aes');
SELECT vsql_crypto.decrypt(@encrypted, @key, 'aes') = @plaintext;
vsql_crypto.decrypt(@encrypted, @key, 'aes') = @plaintext
1
SET @data = 'The quick brown fox jumps over the lazy dog';
SET @key256 = 'this-is-a-32-byte-key-for-aes';
SET @enc = vsql_crypto.encrypt(@data, @key256, 'aes-256');
SELECT vsql_crypto.decrypt(@enc, @key256, 'aes-256') = @data;
vsql_crypto.decrypt(@enc, @key256, 'aes-256') = @data
1
SET @binary = UNHEX('DEADBEEF');
SET @key_aes = 'sixteen-byte-key';
SET @enc_aes = vsql_crypto.encrypt(@binary, @key_aes, 'aes');
SELECT HEX(vsql_crypto.decrypt(@enc_aes, @key_aes, 'aes'));
HEX(vsql_crypto.decrypt(@enc_aes, @key_aes, 'aes'))
DEADBEEF
SET @data128 = 'AES-128 test data';
SET @key128 = 'sixteen-byte-key';
SET @enc128 = vsql_crypto.encrypt(@data128, @key128, 'aes-128');
SELECT vsql_crypto.decrypt(@enc128, @key128, 'aes-128') = @data128;
vsql_crypto.decrypt(@enc128, @key128, 'aes-128') = @data128
1
SET @data192 = 'AES-192 test data';
SET @key192 = 'twentyfour-byte-key-here!';
SET @enc192 = vsql_crypto.encrypt(@data192, @key192, 'aes-192');
SELECT vsql_crypto.decrypt(@enc192, @key192, 'aes-192') = @data192;
vsql_crypto.decrypt(@enc192, @key192, 'aes-192') = @data192
1
SET @salt256 = vsql_crypto.gen_salt('pbkdf2-sha256', 10000);
SELECT @salt256 LIKE '$pbkdf2-sha256$10000$%';
@salt256 LIKE '$pbkdf2-sha256$10000$%'
1
SET @hash256 = vsql_crypto.crypt('mypassword', @salt256);
SELECT @hash256 LIKE '$pbkdf2-sha256$10000$%$%';
@hash256 LIKE '$pbkdf2-sha256$10000$%$%'
1
SET @hash256_verify = vsql_crypto.crypt('mypassword', @salt256);
SELECT @hash256 = @hash256_verify;
@hash256 = @hash256_verify
1
SET @hash256_wrong = vsql_crypto.crypt('wrongpassword', @salt256);
SELECT @hash256 != @hash256_wrong;
@hash256 != @hash256_wrong
1
SET @salt512 = vsql_crypto.gen_salt('pbkdf2-sha512', 10000);
SELECT @salt512 LIKE '$pbkdf2-sha512$10000$%';
@salt512 LIKE '$pbkdf2-sha512$10000$%'
1
SET @hash512 = vsql_crypto.crypt('mypassword', @salt512);
SELECT @hash512 LIKE '$pbkdf2-sha512$10000$%$%';
@hash512 LIKE '$pbkdf2-sha512$10000$%$%'
1
SET @salt_short = vsql_crypto.gen_salt('sha256', 5000);
SELECT @salt_short LIKE '$pbkdf2-sha256$5000$%';
@salt_short LIKE '$pbkdf2-sha256$5000$%'
1
SET @salt_short512 = vsql_crypto.gen_salt('sha512', 5000);
SELECT @salt_short512 LIKE '$pbkdf2-sha512$5000$%';
@salt_short512 LIKE '$pbkdf2-sha512$5000$%'
1
UNINSTALL EXTENSION vsql_crypto;
